<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>sysdiagram - Diagram the system architecture using JavaScript syntax.</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="description" content="Description">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/docsify@4/lib/themes/vue.css">
  
  <style>
    .sysdiagram {
	  text-align: center;
	  border: 1px solid #aaa;
	  width: 100%;
	  height: 600px;
	  border-radius: 8px;
	  padding: 5px;
	}
	
	footer {
	  text-align: center;
	}
	
	.resource-image {
		height: 40px;
		vertical-align: middle;
		float: right;
		top: 5px;
		position: relative;
		background-color: #f9f9f9;
		border-radius: 8px;
	}
	
	.resource li {
		width: 650px;
		line-height: 50px;
	}
  </style>
  
</head>
<body>
  <div id="app"></div>
  <script>
    window.$docsify = {
      name: 'Sysdiagram',
      repo: 'https://github.com/succeun/sysdiagram',
	  //logo: 'images/logo.png',
	  loadSidebar: true,
	  auto2top: true,
	  themeColor: '#3F51B5',
	  maxLevel: 4,
      //subMaxLevel: 2,
	  executeScript: true,
	  plugins: [
		function(hook, vm) {
			hook.afterEach(function (html, next) {
				// We load the HTML inside a DOM node to allow for manipulation
				/*var htmlElement = document.createElement('div');
				htmlElement.innerHTML = html;

				htmlElement.querySelectorAll('pre[data-lang=sysdiagram]').forEach((element, index) => {
					// Create a <div class="sysdiagram"> to replace the <pre> 
					var replacement = document.createElement('div');
					replacement.textContent = element.textContent;
					replacement.classList.add('sysdiagram');

					// Replace
					element.parentNode.replaceChild(replacement, element);
				});*/
				
				// We load the HTML inside a DOM node to allow for manipulation
				var htmlElement = document.createElement('div');
				htmlElement.innerHTML = html;
				
				htmlElement.querySelectorAll('pre[data-lang=js]').forEach((element, index) => {
					// Create a <div class="sysdiagram"> to replace the <pre> 
					var replacement = document.createElement('div');
					replacement.textContent = element.textContent;
					replacement.classList.add('sysdiagram');

					// Replace
					element.parentNode.insertBefore(replacement, element.nextSibling);
				});

				next(htmlElement.innerHTML);
			});

			hook.doneEach(function () {
				sysdiagram.init({}, '.sysdiagram');
			});
		},
		function(hook) {
          var footer = [
            '<hr/>',
            '<footer>',
            '<span>Proudly published with <a href="https://docsify.js.org" target="_blank">docsify</a>.</span>',
            '</footer>'
          ].join('');

          hook.afterEach(function(html) {
            return html + footer;
          });
        }
	  ],
	  ga: 'G-ZY16EZMCRY',
    }
	
	function listResources(resourceName, baseUrl) {
		var main = document.querySelector('#main');
		var lines = [];
		var diagrams = sysdiagram.loadResources();
		var resources = diagrams[resourceName];
		
		for (var x in resources) {
			var id = resourceName + x;	// ex: onpremaggregator
			var path = resourceName + "." + x;	// ex: onprem.aggregator
			lines.push('<h2 id="'+id+'"><a href="#/nodes/'+resourceName+'?id='+id+'" data-id="'+id+'" class="anchor"><span>'+path+'</span></a></h2>');
			lines.push('<ul>');
			for (var y in resources[x]) {
				var p = 'diagrams.'+path+'.'+y;
				var image = resources[x][y].imageURL;
				lines.push('<li><strong>'+p+'</strong> <img class="resource-image" src="'+image+'" loading="lazy"></li>');
			}
			lines.push('</ul>');
		}
		
		var fragment = document.createDocumentFragment();
		var div = document.createElement('div');
		fragment.appendChild(div);
		div.innerHTML = lines.join("\n");
		div.className = "resource";
		
		main.insertBefore(fragment.querySelector('div'), main.querySelector('hr'));
	}
  </script>
  <!-- Docsify v4 -->
  <script src="//cdn.jsdelivr.net/npm/docsify@4"></script>
  
  <script src="//cdn.jsdelivr.net/npm/docsify@4/lib/plugins/ga.min.js"></script>
  
  <!-- sysdiagram -->
  <script src="https://unpkg.com/d3@6.7.0/dist/d3.min.js"></script>
  <script src="https://unpkg.com/@hpcc-js/wasm@1.5.2/dist/index.min.js"></script>
  <script src="https://unpkg.com/d3-graphviz@4.0.0/build/d3-graphviz.js"></script>

  <script src="https://unpkg.com/canvg@3.0.7/lib/umd.js"></script> 

  <script src="https://cdn.jsdelivr.net/gh/succeun/sysdiagram@master/dist/sysdiagram.js"></script>
  
  <!--script src="../dist/sysdiagram.js"></script-->
  
</body>
</html>
